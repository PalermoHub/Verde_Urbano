<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> üå≥ Rigenerazione del Verde Urbano di Palermo: Riqualificazione Stradale e Arredo della Citt√†</title>
	<meta name="description" content="Progetto di riqualificazione e rigenerazione delle strade e delle aree verdi della citt√† di Palermo, volto al miglioramento della qualit√† urbana e della sostenibilit√† ambientale. Gli interventi prevedono la piantumazione e la sostituzione delle alberature esistenti, l'esecuzione di servizi colturali, il ripristino delle aiuole e dei marciapiedi danneggiati, nonch√© la fornitura e la posa in opera di arredi urbani funzionali e di sistemi di illuminazione alimentati da energia solare. - Accordo Quadro - CUP D71G23000050001 ">
	    <meta name="author" content="Giovan Battista Vitrano">
    <meta http-equiv="content-language" content="IT">
    <meta name="robots" content="index,follow">
    <meta name="creation_Date" content="24/12/2025">
	    <link rel="shortcut icon" href="favicon.ico"/> 
    <link rel="icon" href="favicon.png" type="image/png"/> 
	
		<link rel="stylesheet" href="css/css_base.css">
    <link rel="stylesheet" href="css/verde_urbano.css">
	<link rel="stylesheet" href="css/navigation.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Titillium+Web:wght@300;400;600;700&display=swap" rel="stylesheet">
	
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-hash@0.2.1/leaflet-hash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
   
       <!-- Meta tags per social sharing -->
    <meta property="og:url" content="https://palermohub.github.io/Verde_Urbano/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Rigenerazione del Verde Urbano di Palermo: Riqualificazione Stradale e Arredo della Citt√† - Accordo Quadro - CUP D71G23000050001">
    <meta property="og:description" content="Ufficio Autonomo Gestione Verde Urbano, Agricoltura Urbana e Rapporti con Re.Se.T.">
    <meta property="og:image" content="https://palermohub.github.io/Verde_Urbano/img/Social_Card.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="palermohub.opendatasicilia.it">
    <meta property="twitter:url" content="https://palermohub.github.io/Verde_Urbano/">
    <meta name="twitter:title" content="Rigenerazione del Verde Urbano di Palermo: Riqualificazione Stradale e Arredo della Citt√† Accordo Quadro - CUP D71G23000050001">
    <meta name="twitter:description" content="Ufficio Autonomo Gestione Verde Urbano, Agricoltura Urbana e Rapporti con Re.Se.T.">
    <meta name="twitter:image" content="https://palermohub.github.io/Verde_Urbano/img/Social_Card.jpg">
   
 	 <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-KHR1GHDRQS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-KHR1GHDRQS');
</script>	   
   
</head>
<body>
<!-- DEMO Stamp -->
    <div class="demo-stamp">DEMO!</div>

    <!-- LIVELLO 1: SLIM HEADER (Blu) -->
    <div class="slim-header" id="slimHeader">
        <div class="slim-container">
            <div class="slim-left">
                <a href="https://www.comune.palermo.it/" target="_blank"> 
                    <img src="img/logo_pa_gb.svg" alt="Logo Comune di Palermo" class="header-logo">
                </a>
            </div>
        </div>
    </div>

    <!-- LIVELLO 2: HEADER CENTRALE (Verde con Logo) -->
    <header class="main-header" id="mainHeader">
        <div class="main-container">
            <div class="logo-section" id="logoSection">
                <div class="header-text">
                    <h1>Ufficio autonomo gestione verde urbano, agricoltura urbana e rapporti con RESET</h1>
                    <p></p>
                </div>
            </div>
            <div class="header-actions">
                <div class="info-icon" id="infoBtn" title="Informazioni su questa app">
                    <i class="fas fa-circle-info"></i>
                </div>

            </div>
        </div>
    </header>

    <!-- Banner Progetto - SEMPRE VISIBILE -->
    <div class="project-banner" id="projectBanner">
        <div class="banner">
            <h2>
                <!-- BLOCCO 1: Sempre visibile (icona + titolo base) -->
                <span class="banner-text-base">
                    <img src="img/trees.svg" alt="" height="36" class="banner-icon"/>
                    Rigenerazione del Verde Urbano di Palermo
                </span>
                <!-- BLOCCO 2: Visibile solo desktop (testo completo + link) -->
                <span class="banner-text-extra">
                    : Riqualificazione Stradale e Arredo della Citt√† -
                    <a href="https://www.opencup.gov.it//portale/it/web/opencup/home/progetto/-/cup/D71G23000050001"
                       target="_blank" title="Visualizza su OpenCUP">
                        Accordo Quadro - CUP D71G23000050001
                    </a>
                </span>
            </h2>
			<button class="menu-toggle" id="menuToggle" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </div>

    <!-- LIVELLO 3: NAVIGAZIONE - SEMPRE VISIBILE -->
    <div class="nav-header" id="navHeader">
        <div class="nav-container">
            <nav>
                <ul id="navMenu">
                    <li><a href="index.html"><i class="fas fa-map-location-dot"></i> Dashboard</a></li>
                    <li><a href="il-progetto.html"><i class="fas fa-book-open"></i> Il Progetto</a></li>
                    <li><a href="obiettivi.html"><i class="fas fa-bullseye"></i> Obiettivi e Finalit√†</a></li>
                    <li><a href="fasi.html"><i class="fas fa-tasks"></i> Fasi dell'Intervento</a></li>
                    <li><a href="potatura.html"><i class="fas fa-scissors"></i> Tipologie di Potatura</a></li>
                    <li><a href="radicali.html"><i class="fas fa-code-branch"></i> Gestione Apparati Radicali</a></li>
                    <li><a href="impianti.html"><i class="fas fa-tree"></i> Nuovi Impianti</a></li>
                    <li><a href="sicurezza.html"><i class="fas fa-hard-hat"></i> Sicurezza e Cantiere</a></li>
                    <li><a href="dati-economici.html"><i class="fas fa-euro-sign"></i> Dati Economici</a></li>
                </ul>
            </nav>
        </div>
    </div>
    
	
	    <!-- Include Modale Info da file esterno -->
    <script>
        fetch('includes/info-modal.html?v=' + Date.now())
            .then(response => response.text())
            .then(data => {
                document.body.insertAdjacentHTML('beforeend', data);
                // Reinizializza gli event listener del modale dopo il caricamento
                if (typeof window.initInfoModal === 'function') {
                    window.initInfoModal();
                }
            })
            .catch(error => console.error('Errore caricamento modale:', error));
    </script>


    <div class="container">
        <!-- Sidebar Sinistra: Filtri -->
        <div class="sidebar sidebar-left">
            <div class="info-banner">
                <i class="fas fa-info-circle"></i> I filtri aggiornano mappa e grafici in tempo reale
            </div>

            <!-- Banner albero selezionato -->
            <div id="selectedTreeBanner" class="selected-tree-banner" style="display: none;">
                <div style="flex: 1;">
                    <i class="fas fa-map-marker-alt"></i> <strong>Albero selezionato:</strong>
                    <div id="selectedTreeName" style="margin-top: 5px; font-size: 11px;"></div>
                </div>
                <button onclick="clearSelectedTreeFilter()" style="background: #e74c3c; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;">
                    <i class="fas fa-times"></i> Deseleziona
                </button>
            </div>

            <h2><i class="fas fa-search"></i> Filtri</h2>

<!-- Territorio -->

            <div class="filter-group">
                <label>Odonimo (Strada)</label>
                <select id="odonimoFilter" onchange="applyFilters()">
                    <option value="">Tutte le strade</option>
                </select>
                <div class="filter-info" id="odonimoInfo"></div>
            </div>

            <div class="filter-group">
                <label>Circoscrizione</label>
                <select id="circoscrizioneFilter" onchange="applyFilters()">
                    <option value="">Tutte le circoscrizioni</option>
                </select>
                <div class="filter-info" id="circoscrizioneInfo"></div>
            </div>

            <div class="filter-group">
                <label>Quartiere</label>
                <select id="quartiereFilter" onchange="applyFilters()">
                    <option value="">Tutti i quartieri</option>
                </select>
                <div class="filter-info" id="quartiereInfo"></div>
            </div>

            <div class="filter-group">
                <label>UPL</label>
                <select id="uplFilter" onchange="applyFilters()">
                    <option value="">Tutte le UPL</option>
                </select>
                <div class="filter-info" id="uplInfo"></div>
            </div>

<hr>

<!-- Alberi -->
            <div class="filter-group">
                <label>Specie Botanica</label>
                <select id="specieFilter" onchange="applyFilters()">
                    <option value="">Tutte le specie</option>
                </select>
                <div class="filter-info" id="specieInfo"></div>
            </div>

            <div class="filter-group">
                <label>Stato Salute (CPC)</label>
                <select id="cpcFilter" onchange="applyFilters()">
                    <option value="">Tutti</option>
                    <option value="B">B - Bassa</option>
                    <option value="C">C - Moderata</option>
                    <option value="C/D">C/D - Elevata</option>
                    <option value="D">D - Estrema</option>
                    <option value="Ceppaia">Ceppaia</option>
                </select>
                <div class="filter-info" id="cpcInfo"></div>
            </div>

            <div class="filter-group">
                <label>Dimora</label>
                <select id="siteFilter" onchange="applyFilters()">
                    <option value="">Tutti i siti</option>
                </select>
                <div class="filter-info" id="siteInfo"></div>
            </div>

            <div class="filter-group">
                <label>Altezza Minima (m)</label>
                <input type="range" id="minHeight" min="0" max="16" value="0" onchange="updateHeightLabel(); applyFilters()">
                <div class="filter-info">Min: <span id="minHeightLabel">0</span>m</div>
            </div>

            <div class="filter-group">
                <label>Diametro Minimo (cm)</label>
                <input type="range" id="minDiameter" min="0" max="137" value="0" onchange="updateDiameterLabel(); applyFilters()">
                <div class="filter-info">Min: <span id="minDiameterLabel">0</span>cm</div>
            </div>

<hr>
            <div class="filter-group">
                <label><i class="fas fa-tasks"></i> Fase Lavorazione</label>
                <select id="faseFilter" onchange="applyFilters()">
                    <option value="">Tutte le fasi</option>
                    <option value="fase1">Solo Fase 1 (Potatura/Abbattimento)</option>
                    <option value="fase2">Con Fase 2 (Rimozione ceppo)</option>
                    <option value="fase3">Con Fase 3 (Nuova pianta)</option>
                    <!-- FASE 4 DISATTIVATA - Non rientra nei filtri e nel calcolo del costo finale -->
                    <!-- <option value="fase4">Con Fase 4 (Pali tutori)</option> -->
                </select>
                <div class="filter-info" id="faseInfo"></div>
            </div>

<hr>

            <div class="filter-group">
                <label><i class="fas fa-broom"></i> Necessit√† Pulizia Foglie</label>
                <select id="puliziaFilter" onchange="applyFilters()">
                    <option value="">Tutti gli alberi</option>
                    <option value="alta">Alta priorit√† (&gt;30% variazione)</option>
                    <option value="media">Media priorit√† (15-30%)</option>
                    <option value="bassa">Bassa priorit√† (&lt;15%)</option>
                </select>
                <div class="filter-info" id="puliziaInfo"></div>
            </div>

            <hr>

            <h2 style="margin-top: 25px;"><i class="fas fa-tools"></i> Cod. Lavorazione</h2>
            <div id="statLavorazione" style="font-size: 12px; color: #666;">
                <!-- Popolato dinamicamente -->
            </div>



            <h2 style="margin-top: 25px;"><i class="fas fa-euro-sign"></i> Costo Lavorazione (Dato indicativo)</h2>
            <div class="stats-box" style="background: linear-gradient(135deg, #f39c12 0%, #d68910 100%);">
                <div class="stat-row">
                    <span>Costo totale:</span>
                    <span class="stat-value" id="statTotalWorkingCost">0 ‚Ç¨</span>
                </div>
				</div>
				<p style="font-size: 10px; font-style: italic;"><b>NOTA IMPORTANTE:</b> I costi indicati sono suscettibili di variazioni a causa di: modifiche in corso d'opera, variazione dei prezzi delle materie prime, esigenze progettuali non preventivate, ecc.</p>
        </div>

        <!-- Area Centrale: Mappa -->
        <div class="main">
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>

        <!-- Sidebar Destra: Controlli e Grafici -->
        <div class="sidebar sidebar-right">
            <h2><i class="fas fa-sliders"></i> Controlli, Statistiche e DatyaViz</h2>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
			<!-- Pulsanti -->
                <button onclick="applyFilters()">‚úì Applica</button>
                <button class="secondary" onclick="resetFilters()">‚Ü∫ Ripristina</button>

                <button style="padding: 11px; background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px; transition: all 0.3s;" onclick="showActiveFilters()" title="Mostra i filtri attivi">
                    <i class="fas fa-filter"></i> Filtri Attivi
                </button>
                <button class="secondary" style="padding: 11px; font-size: 13px;" onclick="toggleFiltersSidebar()" title="Nascondi/Mostra filtri">
                    <i class="fas fa-bars"></i> Toggle
                </button>

            <!--    <button style="padding: 11px; background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px; transition: all 0.3s;" onclick="downloadRelazione()" title="Scarica la Relazione Tecnica">
                    <i class="fas fa-file-pdf"></i> Relazione
                </button>
                <button style="padding: 11px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; font-size: 13px; transition: all 0.3s;" onclick="printMapPdf()" title="Stampa la mappa in PDF">
                    <i class="fas fa-map"></i> Mappa PDF
                </button> -->
            </div>
						



            <h2 style="margin-top: 25px;"><i class="fas fa-chart-simple"></i> Statistiche sulle Specie arboree</h2>
            <div class="stats-box">
                <div class="stat-row">
                    <span>Alberi Visualizzati</span>
                    <span class="stat-value" id="statFiltered">0</span>
                </div>
                <div class="stat-row">
                    <span>Totale Dataset</span>
                    <span class="stat-value" id="statTotal">0</span>
                </div>
                <div class="stat-row">
                    <span>Altezza Media</span>
                    <span class="stat-value" id="statAvgHeight">-</span>
                </div>
                <div class="stat-row">
                    <span>Diametro Medio</span>
                    <span class="stat-value" id="statAvgDiameter">-</span>
                </div>
                <div class="stat-row">
                    <span>Specie Presenti</span>
                    <span class="stat-value" id="statSpecies">0</span>
                </div>
            </div>

            <h2 style="margin-top: 25px;"><i class="fas fa-map-location-dot"></i> Statistiche sul Territorio</h2>
            <div class="stats-box" style="background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);">
                <div class="stat-row">
                    <span>Vie interessate dalla Rigenerazione <br> del Verde Urbano:</span>
                    <span class="stat-value" style="font-size:30px" id="statTotalStrade">0</span>
                </div>
                <div style="margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px;">UPL</div>
                    <div id="statAlberiPerUPL">-</div>
                </div>
                <div style="margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px;">Quartiere</div>
                    <div id="statAlberiPerQuartiere">-</div>
                </div>
                <div style="margin-top: 15px;">
                    <div style="font-weight: 600; margin-bottom: 8px; font-size: 12px; border-bottom: 1px solid rgba(255,255,255,0.3); padding-bottom: 5px;">Circoscrizione</div>
                    <div id="statAlberiPerCircoscrizione">-</div>
                </div>
            </div>

            <h2 style="margin-top: 25px;"><i class="fas fa-leaf"></i> Benefici  Ambientali</h2>
			<img src="img/co2-albero.svg" width="300" style="display: block; margin: 0 auto;" Title="CO‚ÇÇ assorbita - O‚ÇÇ prodotto" alt="Benefici Ambientali">
            <div class="stats-box" style="background: linear-gradient(135deg, #27ae60 0%, #1e8449 100%);">
                                <div class="stat-row">
                    <span>Assorbimento CO‚ÇÇ totale:</span>
                    <span class="stat-value" id="statTotalCO2">0 kg/anno</span>
                </div>
				<div class="stat-row">
                    <span>Produzione O‚ÇÇ totale:</span>
                    <span class="stat-value" id="statTotalO2">0 kg/anno</span>
                </div>
				 </div>
            <h2><i class="fas fa-chart-bar"></i> DatyaViz</h2>
            <div class="charts-container">
			                <div class="chart-box">
                    <h3><i class="fas fa-leaf"></i> Specie arboree principali</h3>
                    <div class="chart-wrapper">
                        <canvas id="speciesChart"></canvas>
                    </div>
                </div>	
				
                <div class="chart-box">
                    <h3><i class="fas fa-tree"></i> Stato salute - Classe Propensione Cedimento - CPC</h3>
                    <div class="chart-wrapper">
                        <canvas id="healthChart"></canvas>
                    </div>
                </div>
								
                <div class="chart-box">
                    <h3><i class="fas fa-location-dot"></i> Dimora</h3>
                    <div class="chart-wrapper">
                        <canvas id="siteChart"></canvas>
                    </div>
                </div>
				                <div class="chart-box">
                    <h3><i class="fas fa-chart-line"></i> Distribuzione altezze</h3>
                    <div class="chart-wrapper">
                        <canvas id="heightChart"></canvas>
                    </div>
                </div>

				<div class="chart-box chart-box-full">
                    <h3><i class="fas fa-seedling"></i> Foglie totali nelle stagioni</h3>
                    <div class="chart-wrapper" style="height: 350px;">
                        <canvas id="seasonalLeavesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale Dettagli Albero -->
    <div class="modal-overlay" id="treeDetailsModal">
        <div class="modal modal-tree-details">
            <div class="modal-header">
                <h2><i class="fas fa-leaf"></i> Dettagli Albero</h2>
                <button class="modal-close" onclick="closeTreeDetails()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="selectedTreeInfo" class="details-grid">
                    <div class="no-data"><i class="fas fa-hand-pointer"></i> <b> Fai clic su un albero per visualizzare o stampare la scheda informativa</b></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale Filtri Attivi -->
    <div class="modal-overlay" id="activeFiltersModal">
        <div class="modal">
            <div class="modal-header">
                <h2><i class="fas fa-filter"></i> Filtri Attivi</h2>
                <button class="modal-close" onclick="closeActiveFilters()"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="activeFiltersContent">
                    <!-- Popolato dinamicamente -->
                </div>
            </div>
        </div>
    </div>


<script src="js/01_modal.js"></script>
<script src="js/02_csv_loader.js"></script>
<script src="js/03_global_variables.js"></script>
<script src="js/04_init.js"></script>
<script src="js/05_map.js"></script>
<script src="js/06_data_loader.js"></script>
<script src="js/07_filters.js"></script>
<script src="js/08_environmental_calculations.js"></script>
<script src="js/09_statistics.js"></script>
<script src="js/10_tree_details.js"></script>
<script src="js/11_pdf_generator.js"></script>
<script src="js/12_charts.js"></script>
<script src="js/13_reports.js"></script>
<script src="js/14_active_filters.js"></script>

    <!-- Include Footer da file esterno -->
    <script>
        fetch('includes/footer.html?v=' + Date.now())
            .then(response => response.text())
            .then(data => {
                document.body.insertAdjacentHTML('beforeend', data);
            })
            .catch(error => console.error('Errore caricamento footer:', error));
    </script>

    <!-- Script per evidenziare la voce attiva nella sidebar -->
    <script>
    (function() {
        const sidebarLinks = document.querySelectorAll('.sidebar-nav a');

        function highlightActiveSection() {
            let current = '';
            const sections = document.querySelectorAll('.content-section[id]');

            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }
            });

            sidebarLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        }

        window.addEventListener('scroll', highlightActiveSection);
        window.addEventListener('load', highlightActiveSection);
    })();
    </script>

    <!-- Script per sticky header -->
    <script src="js/header.js"></script>

</body>
</html>
